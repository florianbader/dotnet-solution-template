parameters:
  - name: FilePath
    type: string

  - name: Tokens
    type: object

steps:
  - script: |
      printenv | grep TOKENS_ | sed 's/TOKENS_//g' | while read -r line ; do
          IFS='='
          read -a token <<< "$line"
          sed -i "s/__${token[0]}__/${token[1]}/g" ${{ parameters.FilePath }}
      done
    displayName: Tokenize file
    env:
      ${{ each pair in parameters.Tokens }}:
        TOKENS_${{ pair.key }}: ${{ pair.value }}
